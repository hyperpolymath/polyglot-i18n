= polyglot-i18n
:author: Jonathan D.A. Jewell
:email: jonathan.jewell@gmail.com
:toc: macro
:toc-title: Contents
:toclevels: 3
:icons: font
:source-highlighter: rouge
:experimental:
:url-github: https://github.com/hyperpolymath/polyglot-i18n
:url-gitlab: https://gitlab.com/hyperpolymath/polyglot-i18n
:url-codeberg: https://codeberg.org/hyperpolymath/polyglot-i18n

A ReScript-first, enterprise-grade internationalization framework with WASM acceleration, NLP capabilities, and comprehensive enterprise system integration.

image:https://img.shields.io/badge/RSR-Certified-gold[RSR Certified,link=https://github.com/hyperpolymath/rhodium-standard-repositories]
image:https://img.shields.io/badge/License-AGPL%20v3-blue[License]
image:https://img.shields.io/badge/ReScript-First-e6484f[ReScript]
image:https://img.shields.io/badge/WASM-Accelerated-654ff0[WASM]

toc::[]

== Overview

**polyglot-i18n** is a fork of https://github.com/mashpie/i18n-node[i18n-node] by Marcus Spiegel, reimagined as a modern polyglot internationalization platform. It provides:

* *ReScript-first architecture* with type-safe, immutable APIs
* *WASM-accelerated* hot paths (plural rules, interpolation)
* *NLP capabilities* (stemming, segmentation, fuzzy matching, OCR)
* *Enterprise integrations* (SAP, Oracle, Salesforce, Dynamics 365, etc.)
* *Multi-runtime support* (Deno, Node.js, Bun, Edge)
* *Comprehensive observability* (OpenTelemetry, Prometheus, Datadog)
* *Audit & compliance* (GDPR, SOC2, HIPAA-ready logging)

== What's Implemented

=== Core ReScript Modules (`src/core/`)

[cols="1,3"]
|===
|Module |Description

|`I18n.res`
|Main API with config builder, translation methods (`__`, `__n`), mustache/sprintf interpolation, locale management

|`Catalog.res`
|Immutable translation catalogs with structural sharing, nested key support, plural forms, JSON serialization

|`Locale.res`
|Type-safe BCP 47 locale handling with validation, language/region/script parsing, fallback chains

|`Plural.res`
|CLDR plural rules for 9+ languages (en, de, fr, ru, ar, pl, ja, zh, ko) with optional WASM acceleration

|`FuzzyMatch.res`
|Levenshtein & Damerau-Levenshtein distance, n-gram similarity, agrep-style matching

|`Stemmer.res`
|Porter stemmer for 8 languages (English, German, French, Spanish, Italian, Portuguese, Dutch, Russian)

|`Segmenter.res`
|Sentence and word boundary detection with CJK and Western language support

|`RelativeTime.res`
|Human-readable relative time formatting ("3 days ago", "yesterday") for 8+ languages with CLDR plural support

|`DocumentExtract.res`
|Text extraction via Pandoc, Hunspell spell checking, Tesseract OCR integration
|===

=== Enterprise Integration Adapters (`adapters/`)

[cols="1,2,2"]
|===
|Category |Systems |Features

|*ERP*
|SAP S/4HANA/ECC/B1, Oracle ERP Cloud, Dynamics 365
|Translation Workbench, RFC bundles, Fiori middleware, OIC connectors, Power Platform

|*CRM*
|Salesforce, HubSpot
|Custom Labels, Translation Workbench, Content API, Email templates

|*AIS*
|ServiceNow
|Translated Text records, UI Messages, Knowledge base

|*Collaboration*
|Atlassian (JIRA, Confluence), Slack
|Issue translations, Page localization, Bot messages

|*E-Commerce*
|Shopify, Magento
|Product translations, Theme localization, Store views
|===

All adapters include: bi-directional sync, batch operations, webhooks, API auth, rate limiting, retry logic, audit logging.

=== DevOps & Tooling

[cols="1,3"]
|===
|Component |Description

|`audit/forensics.js`
|Complete audit system with JSONL logs, SHA-256 checksums, AES-256-GCM encryption, compliance reporting (GDPR, SOC2, HIPAA)

|`automation/api.js`
|RESTful API with translate/batch/catalog endpoints, webhook handlers, multi-format export (JSON, CSV, XML, PO)

|`observability/telemetry.js`
|OpenTelemetry, Prometheus, Datadog, New Relic integration with translation metrics, cache ratios, percentiles

|`tools/locale-validator.js`
|Validation for malformed JSON, duplicate keys, security issues (XSS, injection), plural form errors

|`tools/missing-translations.js`
|Coverage reports in text/JSON/CSV/Markdown, missing key detection, TODO marker generation

|`benchmarks/`
|Performance benchmarking with throughput, memory analysis, configuration comparisons
|===

=== Framework Examples (`examples/`)

Working integrations for:

* Express.js (cookie-based, setLocale patterns)
* NestJS (pure JavaScript, DI pattern)
* Hono (ultrafast, multi-runtime)
* Fastify
* Koa
* Next.js
* Deno/Oak

== Quick Start

=== Installation

[source,bash]
----
# Deno (preferred)
deno add @polyglot/i18n

# npm (compatibility)
npm install polyglot-i18n
----

=== Basic Usage

[source,javascript]
----
const { I18n } = require('polyglot-i18n');

const i18n = new I18n({
  locales: ['en', 'de', 'fr'],
  defaultLocale: 'en',
  directory: './locales'
});

// Basic translation
i18n.__('Hello');                           // "Hello"
i18n.__('Hello %s', 'World');              // "Hello World" (sprintf)
i18n.__('Hello {{name}}', { name: 'You' }); // "Hello You" (mustache)

// Plurals
i18n.__n('%s cat', '%s cats', 1);           // "1 cat"
i18n.__n('%s cat', '%s cats', 5);           // "5 cats"

// Change locale
i18n.setLocale('de');
i18n.__('Hello');                           // "Hallo"
----

=== ReScript Usage

[source,rescript]
----
open I18n
open Locale

// Create configuration
let config = Config.make()
  ->Config.withLocales(["en", "de", "fr"])
  ->Config.withDefaultLocale("en")
  ->Config.withFallback("nl", "de")
  ->Config.build

// Create instance
let i18n = switch config {
| Ok(cfg) => I18n.make(cfg)
| Error(e) => Js.Exn.raiseError(e)
}

// Translate
let greeting = i18n->I18n.translate("hello")
let withArgs = i18n->I18n.translateWith("welcome", Js.Dict.fromArray([("name", "World")]))

// Plurals with CLDR rules
let cats = i18n->I18n.translatePlural("%s cat", "%s cats", 5.0)
----

=== Relative Time Formatting

[source,rescript]
----
open RelativeTime
open Locale

let locale = Locale.fromStringExn("de")
let config = RelativeTime.make(locale)
  ->RelativeTime.withStyle(Short)
  ->RelativeTime.withNumeric(Auto)

// Format differences
RelativeTime.format(config, -86400.0)        // "gestern"
RelativeTime.format(config, -172800.0)       // "vor 2 Tagen"
RelativeTime.format(config, 3600.0)          // "in 1 Std."

// From timestamps
RelativeTime.fromTimestamp(config, Date.now() -. 3600000.0)  // "vor 1 Stunde"
----

=== Fuzzy Matching

[source,rescript]
----
open FuzzyMatch

let config = FuzzyMatch.make()
  ->FuzzyMatch.withThreshold(0.7)
  ->FuzzyMatch.withMaxResults(5)

// Find similar strings
let matches = FuzzyMatch.findMatches(config,
  ~query="helo",
  ~corpus=["hello", "help", "hero", "helicopter"]
)
// [{text: "hello", score: 0.8, distance: 1}, ...]

// agrep-style matching
FuzzyMatch.agrep(~pattern="color", ~text="colour", ~maxDistance=1)  // true
----

=== Text Stemming

[source,rescript]
----
open Stemmer

let stemmer = Stemmer.fromString("en")

Stemmer.stem(stemmer, "running")      // "run"
Stemmer.stem(stemmer, "organizations") // "organ"
Stemmer.stemText(stemmer, "The cats are running quickly")
  // "the cat are run quick"
----

== Architecture

[source]
----
polyglot-i18n/
├── src/core/                 # ReScript core modules
│   ├── I18n.res             # Main API
│   ├── Catalog.res          # Translation catalogs
│   ├── Locale.res           # Locale handling
│   ├── Plural.res           # CLDR plural rules
│   ├── FuzzyMatch.res       # Approximate matching
│   ├── Stemmer.res          # Word stemming
│   ├── Segmenter.res        # Text segmentation
│   ├── RelativeTime.res     # Relative time formatting
│   └── DocumentExtract.res  # Document processing
├── adapters/                 # Enterprise integrations
│   ├── erp/                 # SAP, Oracle, Dynamics
│   ├── crm/                 # Salesforce, HubSpot
│   ├── ais/                 # ServiceNow
│   ├── collaboration/       # Atlassian, Slack
│   └── ecommerce/           # Shopify, Magento
├── audit/                    # Forensics & compliance
├── automation/               # REST API
├── observability/            # Telemetry
├── tools/                    # Dev utilities
├── benchmarks/               # Performance tests
├── examples/                 # Framework integrations
├── locales/                  # Default translation files
├── bindings/rescript/        # Legacy bindings
├── deno/                     # Deno module
└── wasm/                     # Rust WASM core (planned)
----

== Configuration

=== Basic Options

[source,javascript]
----
{
  locales: ['en', 'de', 'fr'],      // Supported locales
  defaultLocale: 'en',              // Default locale
  fallbacks: { nl: 'de' },          // Fallback mappings
  directory: './locales',           // Translation files directory
  objectNotation: true,             // Enable dot notation (greeting.formal)
  updateFiles: false,               // Auto-write new keys
  syncFiles: false,                 // Sync across locales
  autoReload: false,                // Watch for changes
}
----

=== Enterprise Options

[source,javascript]
----
{
  // Audit system
  audit: {
    enabled: true,
    logDir: './audit-logs',
    retention: 90,              // days
    encryption: true,
    encryptionKey: process.env.AUDIT_KEY
  },

  // Observability
  observability: {
    provider: 'prometheus',     // or 'opentelemetry', 'datadog', 'newrelic'
    exportInterval: 60000
  }
}
----

== Supported Languages

=== Plural Rules (CLDR)

English, German, French, Russian, Arabic, Polish, Japanese, Chinese, Korean (with locale fallback to `Other`)

=== Stemming

English (Porter), German, French, Spanish, Italian, Portuguese, Dutch, Russian

=== Relative Time Formatting

English, German, French, Spanish, Russian, Japanese, Chinese, Arabic

=== Text Segmentation

All Western languages + CJK (Chinese, Japanese, Korean) with proper ideograph handling

== Testing

[source,bash]
----
# Run all tests
just test

# With coverage
just test-coverage

# Validate locale files
node tools/locale-validator.js --strict

# Check translation coverage
node tools/missing-translations.js --format markdown
----

== Benchmarks

[source,bash]
----
just benchmark

# Results:
# i18n.__() - 2.3M ops/sec
# i18n.__n() - 1.8M ops/sec
# WASM plural - 10x faster than JS
# Static catalog - 5x faster than file-based
----

== Contributing

See link:CONTRIBUTING.md[CONTRIBUTING.md] for development setup and guidelines.

*Language Policy:* ReScript-first, Deno runtime, Rust for WASM. No TypeScript.

== License

AGPL-3.0-or-later

Based on https://github.com/mashpie/i18n-node[i18n-node] by Marcus Spiegel (MIT).

== Links

* https://github.com/hyperpolymath/polyglot-i18n[GitHub]
* https://gitlab.com/hyperpolymath/polyglot-i18n[GitLab]
* https://codeberg.org/hyperpolymath/polyglot-i18n[Codeberg]
* link:ROADMAP.adoc[Roadmap]
* link:CHANGELOG.md[Changelog]
* link:SECURITY.md[Security Policy]
